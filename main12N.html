

<!DOCTYPE html>
<html lang="en">
<head>

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<title>Address For You</title>
<font face="微軟正黑體">微軟正黑體字型</font> 

  <link rel="import" href="lib.html">

<meta charset="UTF-8">

<link rel="stylesheet" href="css/project.css">
<!-- color -->
<link rel="stylesheet" href="css/color.css">  
<script>
var map;
var rawdata=[];
var url = document.location.href;
var params1 = url.split('?')[1];
var tep1 = params1.split('=')[1];
rawdata[0]=tep1.split(',')[0];
rawdata[1]=tep1.split(',')[1];
//topjob
var params2 = url.split('?')[2];
var pa2= JSON.parse(decodeURIComponent(params2));
  console.log(pa2);
var topjob = pa2.v1;
var topsum = pa2.v2;


var job30 =["農產品","食品什貨","菸酒","服飾","家具","五金","日常用品","模具","水電行","清潔用品","化粧品","成藥","樂器","建材","電器","電腦","電信","機械器具","其他機械","機車","汽機車零件","車胎","首飾","資訊軟體","電子材料","便利商店","飲料店","餐館","租賃","美容美髮"];
var cate = [1,1,1,1,2,2,2,3,3,4,4,4,5,5,6,6,6,7,7,8,8,8,5,6,6,9,9,9,10,10];
// var test = [18,137,62,74,32,55,59,10,11,26,54,3,53,34,37,29,29,19,12,44,73,23,12,35,30,29,88,131,25,44];
var idv1 = document.getElementById('v1');


    function initMap() {
    var current_position= {lat:parseFloat(rawdata[0]),lng:parseFloat(rawdata[1])};
     var map = new google.maps.Map(document.getElementById('map'), {
        center:current_position,
        zoom: 15
    });

     var marker = new google.maps.Marker({
    position: current_position,
    map: map,

  });

  var circle = new google.maps.Circle({
  map: map,
  center: current_position,
  strokeColor: '#FF0000',
  strokeOpacity: 0.75,
  strokeWeight: 1,
  radius:500,   //unit metres 
  fillColor: '#AA0000',
  fillOpacity: 0.10,
});

     var map2 = new google.maps.Map(document.getElementById('map2'), {
        center:current_position,
        zoom: 15
    });

     var marker = new google.maps.Marker({
    position: current_position,
    map: map2,

  });

  var circle = new google.maps.Circle({
  map: map2,
  center: current_position,
  strokeColor: '#FF0000',
  strokeOpacity: 0.75,
  strokeWeight: 1,
  radius:500,   //unit metres 
  fillColor: '#AA0000',
  fillOpacity: 0.10,
});

}

</script>
<!-- google map api -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB2zQ2kVsLsIMoMbY3T53_0yzb9jgysVRA&libraries=places&callback=initMap" async defer></script>
<script type="text/javascript">// maincontent control
$(document).ready(function() {

$('#fullpage').fullpage({

anchors:['content1','content2','content3'],
menu:'#sidebar-wrapper',
css3: true,
scrollingSpeed: 1000
});

});</script>

    <style>
    #map {
    height: 400px;
    width :100%;
    }
    #map2{
      height: 300px;
      width:100%;
    }
#wrapper > ul> li>a{
  left: 20px
}
h5{
  font-size: 24px
}
#v1{
  padding-right:55px;
}
#v3{
  padding-top:50px;
}
    </style>

</head>
<body>
  <!-- main bar start  -->
<nav class="navbar navbar-default no-margin navbar-fixed-top" id = "mainbar">
<div class="container-fluid">
<div class="collapse navbar-collapse" >
<div class="navbar-header">
<a href="index.html"><img src="pic/head.png" border="0" height="110px"></a><!--Ryao0824-->

</div>


<ul class="nav navbar-nav navbar-right">
<li><a class="btn hvr-pop "href="index.html"><h4>首頁</h4></a></li>
<li><a href="p1.html" class=" hvr-pop"><h4>研究動機</h4></a></li>
<li class="dropdown">

<a href="#" class="dropdown-toggle hvr-pop" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true"><h4>研究方法<span class="caret"></span></h4></a>

<ul class="dropdown-menu multi-level " role="menu" aria-labelledby="dropdownMenu">
<li>
<a href="p2_1.html" ><h4>研究流程</h4></a>
</li>

<li class="dropdown-submenu"><a tabindex="-1" href="#"><h4>研究理論</h4></a>
<ul class="dropdown-menu ">
 <li><a tabindex="-1" href="p2_21.html"><h4>空間自相關分析</h4></a></li> <!--Ryao0902-->

 <li><a tabindex="-1" href="p2_22.html"><h4>量化商圈資訊</h4></a></li> <!--Ryao0902-->

 <li><a tabindex="-1" href="p2_23.html"><h4>多領域整合</h4></a></li> <!--Ryao0902-->
 
 <li><a tabindex="-1" href="p2_24.html"><h4>變數權重專一化</h4></a></li> <!--Ryao0902-->
</ul>
</li>
</ul>
</li>
<li>
<a href="p3.html" class="hvr-pop"><h4>資料來源</h4></a>
</li>
<li><a href="p4.html" class="hvr-pop"><h4>關於我們</h4></a></li><!--Ryao0902-->
</ul>

</div>
</div>
</nav>
<div id="wrapper">
<!-- Sidebar -->
<ul id="sidebar-wrapper" class="nav nav-stacked affix">

<li  data-menuanchor="content1">
<a href="#content1" class="sidebarC">
<span class="fa-stack fa-lg pull-left"></span>

<h3><img src="pic/star (3).png" height="25" width="25"> 推薦的營業項目</h3></a>
</li>

<li data-menuanchor="content2" >
  <a href="#content2"class="sidebarC"><span class="fa-stack fa-lg pull-left"></span> <h3><img src="pic/location-circular-button-with-placeholder-inside (2).png" height="25" width="25"> 商圈性質</h3></a></li>
<li data-menuanchor="content3">
  <a href="#content3" class="sidebarC"><span class="fa-stack fa-lg pull-left"></span><h3><img src="pic/coin (1).png" height="25" width="25"> 租屋情況</h3></a></li>
 
 </ul>
<div id="page-content-wrapper" style="background-image: url(pic/tepback5.png)" >
<div class="container-fluid xyz " >
<div class="row">
<div class="col-lg-12 ">
<!--  result  main content start --> 
  
<div id="fullpage" class="fullpage-wrapper" style="height: 100%; position: relative; touch-action: none; transform: translate3d(0px, 0px, 0px); transition: all 700ms cubic-bezier(0.175, 0.885, 0.32, 1.275);">


<div role="tabpanel" class="section active tab-pane" id="section0" data-anchor="content1">
<div  class="fp-tableCell" style="height: 100%;">
<div class="container">
<!-- recommend1 -->
<div class="row bg-contentR" >  
<div class="col-lg-6 " >
  <h1>附近適合開的行業</h1>
<div id="map"></div>
</div>
<div class="col-lg-6 " id="recommend1">
    <p class="location_r" id="note">
    <span class="colorBox" style="background-color: #ff7400;"></span>&nbsp;推薦
    <span class="colorBox" style="background-color: #959595;"></span>&nbsp;不推薦
   </p>
<!-- visualize 1  ------------------------------------------------- -->
<div id="v1">
loading
</div></div></div></div></div></div>
<div role="tabpanel" class="section tab-pane " id="section1" data-anchor="content2">

  <div class="fp-tableCell" style="height: 100%;">
<div class="container">
<div class ="row bg-contentR"  >
  <div class="col-lg-5" id ="v3">
    <h1>附近500M的行業泡泡圖</h1><br>
  <div id="map2"></div>
  </div>
    <div class="col-lg-7">
    <div style="height:100% " id="recommend2">
  </div></div>
</div>
</div>
</div>
</div>

<div role="tabpanel" class="tab-pane section" id="section2" data-anchor="content3">

  <div class="fp-tableCell" style="height: 100%;">
<div class="container">
<div class ="row bg-contentR"  >
  <div id="v2"></div>
</div>
</div>
</div>
<div id="v2"></div>
  
</div>
 </div>
<!--  result  main content end--> 
</div></div></div></div>
<!-- /#page-content-wrapper -->
</div>

<script>
for (var i = 0; i < pa2.address.length; i++) {
  j=i+1;
  if(i==0){
  $("#v2").html('<table class="table table-hover"><thead><th><h5>#</h5></th><th><h5>附近租屋行情</h5></th><th><h5>坪數</h5></th><th><h5>價錢</h5></th><th><h5>聯絡人</h5></th></thead><tbody><tr><td><h5>'+j+'</h5></td><td><h5>新莊區'+pa2.address[i]+'</h5></td><td><h5>'+pa2.area[i]+'坪</h5></td><td><h5>'+pa2.price[i]+'/M</h5></td><td><h5>'+pa2.man[i]+'</h5></td></tr>')
}else if (i==pa2.area.length){
  $("v2>table").append('<tr><td><h5>'+j+'</h5></td><td><h5>新莊區'+pa2.address[i]+'</h5></td><td><h5>'+data2.area[i]+'坪</h5></td><td><h5>'+pa2.price[i]+'/M</h5></td><td><h5>'+pa2.man[i]+'</h5></td></tr></tbody></table>')
}
else{
 $("#v2>table").append('<tr><td><h5>'+j+'</h5></td><td><h5>新莊區'+pa2.address[i]+'</h5></td><td><h5>'+pa2.area[i]+'坪</h5></td><td><h5>'+pa2.price[i]+'/M</h5></td><td><h5>'+pa2.man[i]+'</h5></td></tr>');
}
};


j=0;

function add(a, b) {
    return a + b;
}
sum=topjob.reduce(add,0);
if (sum ==0){
$("#v1").html('&nbsp;&nbsp;&nbsp;&nbsp;<img src = pic/null.jpg height=300 padding-left=30px><div style=font-size:20px>非常抱歉這裡並沒有推薦任何行業<br>'+'請再再找找其他地點哦!!<a href=p2_21.html>返回</a></div>')
}else{
for (var i = topjob.length - 1; i >= 0; i--) {
    if(topjob[i]  ==1 ) 
    {
      /*
      idv1.innerHTML = '<div class="btn-group"><button type="button" class="btn btn-top "><span style="font-size:20px;">'+job30[i]+'</span></button></div>';
    */if(j== 0){
       $("#v1").html( '<div class="btn-group"><button type="button" class="btn btn-top "><span style="font-size:22px; ">'+job30[i]+'</span></button></div>');
       j=1;
       job30.splice(i,1);
      }else {
        $("#v1").append('&nbsp;<div class="btn-group"><button type="button" class="btn btn-top "><span style="font-size:22px;">'+job30[i]+'</span></button></div>');
       job30.splice(i,1);
      }
    }
  };
for (var i = 0; i < job30.length; i++) {
       $("#v1").append('&nbsp;<div class="btn-group"><button type="button" class="btn"><span style="font-size:22px;">'+job30[i]+'</span></button></div>');
};
}
</script>
<script>

  var diameter = 580,
    format = d3.format(",d"),
    color = d3.scale.category20c();

var bubble = d3.layout.pack()
    .sort(null)
    .size([diameter, diameter])
    .padding(1.5);

var svg = d3.select("div#recommend2").append("svg")
    .attr("width", diameter)
    .attr("height", diameter)
    .attr("class", "bubble");
var jsondata={"name":"root","children":[{"name":"零售","children":[{"name":"農產品","size":topsum[0]},{"name":"食品什貨","size":topsum[1]},{"name":"菸酒","size":topsum[2]},{"name":"服飾","size":topsum[3]}]},{"name":"家具五金","children":[{"name":"家具","size":topsum[4]},{"name":"五金","size":topsum[5]},{"name":"日用品","size":topsum[6]}]},{"name":"模具水器","children":[{"name":"模具","size":topsum[7]},{"name":"水電行","size":topsum[8]}]},{"name":"藥妝","children":[{"name":"清潔用品","size":topsum[9]},{"name":"化粧品","size":topsum[10]},{"name":"成藥","size":topsum[11]}]},{"name":"雜類","children":[{"name":"樂器","size":topsum[12]},{"name":"建材","size":topsum[13]},{"name":"首飾","size":topsum[22]}]},{"name":"3C","children":[{"name":"電器","size":topsum[14]},{"name":"電腦","size":topsum[15]},{"name":"電信","size":topsum[16]},{"name":"資訊軟體","size":topsum[23]},{"name":"電子材料","size":topsum[24]}]},{"name":"機械","children":[{"name":"機械器具","size":topsum[17]},{"name":"其他機械","size":topsum[18]}]},{"name":"汽機車","children":[{"name":"機車","size":topsum[19]},{"name":"汽機車零件","size":topsum[20]},{"name":"車胎","size":topsum[21]}]},{"name":"吃喝","children":[{"name":"便利商店","size":topsum[25]},{"name":"飲料店","size":topsum[26]},{"name":"餐館","size":topsum[27]}]},{"name":"服務","children":[{"name":"租賃","size":topsum[28]},{"name":"美容美髮","size":topsum[29]}]}]};

d3.json("flare.json", function(error, root) {
  if (error) throw error;
  root =jsondata;
  var node = svg.selectAll(".node")
      .data(bubble.nodes(classes(root))
      .filter(function(d) { return !d.children; }))
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

  node.append("title")
      .text(function(d) { return d.className + ": " + format(d.value); });

  node.append("circle")
      .attr("r", function(d) { return d.r; })
      .style("fill", function(d) { return color(d.packageName); });

  node.append("text")
      .text(function(d) { return d.className.substring(0, d.r / 3); })
      .style("text-anchor", "middle")
      .style("font-size", function(d) { return Math.min(2 * d.r, (2 * d.r - 8) / this.getComputedTextLength() * 12) + "px"; })
      .attr("dy", ".35em");

});

// Returns a flattened hierarchy containing all leaf nodes under the root.
function classes(root) {
  var classes = [];

  function recurse(name, node) {
    if (node.children) node.children.forEach(function(child) { recurse(node.name, child); });
    else classes.push({packageName: name, className: node.name, value: node.size});
  }
  recurse(null, root);
  return {children: classes};
}

d3.select(self.frameElement).style("height", diameter + "px");

</script>
<!-- <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
 -->
</body>
</html>
