



<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<title>Address For You</title>
<font face="微軟正黑體">微軟正黑體字型</font> 

<link rel="import" href="lib.html">
<link rel="stylesheet" type="text/css" href="css/project.css">
<link rel="stylesheet" type="text/css" href="css/color.css">

<script>
var map, rawdata=[];
var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
var labelIndex = 0;
var url = document.location.href;
var data=  (document.location.href).split('?')[1];
var data1 =decodeURI(data);
var data2= JSON.parse(data1);
var tep1 =  (document.location.href).split('?')[2]
rawdata[0]=tep1.split(',')[0];
rawdata[1]=tep1.split(',')[1];
var current_position= {lat:parseFloat(rawdata[0]),lng:parseFloat(rawdata[1])};
function initMap() {
        
map = new google.maps.Map(document.getElementById('map'), {
  center:current_position,
zoom: 15
});
var marker = new google.maps.Marker({
position: current_position,
map: map,

  });

// for(i=0 ;i<data2.address.length;i++){
//   var marker = new google.maps.Marker({
//     position:new google.maps.LatLng(data2.lat[i],data2.lng[i]),
//     map:map
//   });
// }

var geocoder=new google.maps.Geocoder();
geocodeAddress(geocoder,map);
var circle = new google.maps.Circle({
  map: map,
  center: current_position,
  strokeColor: '#FF0000',
  strokeOpacity: 0.75,
  strokeWeight: 1,
  radius:500,   //unit metres 
  fillColor: '#AA0000',
  fillOpacity: 0.10,
});

}
function geocodeAddress(geocoder,resultmap){
  for (var i = 0; i < data2.address.length; i++) {
    var labels='1234567';
    var labelIndex = 0;

    geocoder.geocode({'address':'新莊區'+data2.address[i]},function(results,status){
      if (status === google.maps.GeocoderStatus.OK) {
      resultmap.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({

        map: resultmap,
        label: labels[labelIndex++ % labels.length],
        position: results[0].geometry.location
      });
    } else {
    }
    })
 
  };
  var map2 = new google.maps.Map(document.getElementById('map2'), {
        center:current_position,
        zoom: 15
    });

     var marker = new google.maps.Marker({
    position: current_position,
    map: map2,

  });

  var circle = new google.maps.Circle({
  map: map2,
  center: current_position,
  strokeColor: '#FF0000',
  strokeOpacity: 0.75,
  strokeWeight: 1,
  radius:500,   //unit metres 
  fillColor: '#AA0000',
  fillOpacity: 0.10,
});



}


</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB2zQ2kVsLsIMoMbY3T53_0yzb9jgysVRA&callback=initMap"
async defer></script>
<script type="text/javascript">
// data=  (document.location.href).split('?')[1]
// data1 =decodeURI(data)
// data2= JSON.parse(data1)



// maincontent control
$(document).ready(function() {

$('#fullpage').fullpage({
  anchors:['content1','content2','content3'],
menu:'#sidebar-wrapper',
css3: true,
scrollingSpeed: 1000
});

});</script>
<style>
#map {
height: 400px;
width :100%;
}
#map2{
  height:300px;
  width:100%;
}
#wrapper >ul >li >a{
left:20px;
}
#v3{
  padding-top: 50px
}
</style>
</head>
<body>
<nav class="navbar navbar-default no-margin navbar-fixed-top" id = "mainbar">
<div class="container-fluid">

<div class="collapse navbar-collapse" >
<div class="navbar-header">
<a href="index.html"><img src="pic/head.png" border="0" height="110px"></a><!--Ryao0824-->

</div>


<ul class="nav navbar-nav navbar-right">
<li><a class="btn hvr-pop "href="index.html"><h4>首頁</h4></a></li>
<li><a href="p1.html" class=" hvr-pop"><h4>研究動機</h4></a></li>
<li class="dropdown">

<a href="#" class="dropdown-toggle hvr-pop" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true"><h4>研究方法<span class="caret"></span></h4></a>

<ul class="dropdown-menu multi-level " role="menu" aria-labelledby="dropdownMenu">
<li>
<a href="p2_1.html" ><h4>研究流程</h4></a>
</li>

<li class="dropdown-submenu"><a tabindex="-1" href="#"><h4>研究理論</h4></a>
<ul class="dropdown-menu ">
 <li><a tabindex="-1" href="p2_21.html"><h4>空間自相關分析</h4></a></li> <!--Ryao0902-->

 <li><a tabindex="-1" href="p2_22.html"><h4>量化商圈資訊</h4></a></li> <!--Ryao0902-->

 <li><a tabindex="-1" href="p2_23.html"><h4>多領域整合</h4></a></li> <!--Ryao0902-->
 
 <li><a tabindex="-1" href="p2_24.html"><h4>變數權重專一化</h4></a></li> <!--Ryao0902-->
</ul>
</li>
</ul>
</li>
<li>
<a href="p3.html" class="hvr-pop"><h4>資料來源</h4></a>
</li>
<li><a href="p4.html" class="hvr-pop"><h4>關於我們</h4></a></li><!--Ryao0902-->
</ul>

</div>
</div>
</nav>
<div id="wrapper">
<!-- Sidebar -->
<ul id="sidebar-wrapper" class="nav nav-stacked affix">

<li  data-menuanchor="content1">
<a href="#content1" class="sidebarC">
<span class="fa-stack fa-lg pull-left"></span><h3> <img src="pic/star (3).png" height="25" width="25"> 推薦的店面</h3></a>
</li>

<li data-menuanchor="content2" >
  <a href="#content2"class="sidebarC"><span class="fa-stack fa-lg pull-left"></span> <h3><img src="pic/location-circular-button-with-placeholder-inside (2).png" height="25" width="25"> 商圈性質</h3></a></li>
<li data-menuanchor="content3">
  <a href="#content3" class="sidebarC"><span class="fa-stack fa-lg pull-left"></span><h3><img src="pic/coin (1).png" height="25" width="25"> 租屋情況</h3></a></li>
 
 </ul>
<div id="page-content-wrapper" style="background-image: url(pic/tepback5.png)">
<div class="container-fluid xyz">
<div class="row ">
<div class="col-lg-12">
<!--  result  main content start --> 

<div id="fullpage" class="fullpage-wrapper" style="height: 100%; position: relative; touch-action: none; transform: translate3d(0px, 0px, 0px); transition: all 700ms cubic-bezier(0.175, 0.885, 0.32, 1.275);">


<div role="tabpanel" class="section active tab-pane" id="section0" data-anchor="content1">
<div  class="fp-tableCell" style="height: 100%;">
<div class="container">
<!-- recommend1 -->
<div class="row bg-contentR" id ="recommend1">  
<div class="col-lg-6">
   <h1>附近適合開的店面位置</h1>
<div id="map"></div>
</div>
<div id="v1" class="col-lg-6">
</div></div></div></div></div>
<div role="tabpanel" class="section tab-pane " id="section1" data-anchor="content2">

  <div class="fp-tableCell" style="height: 100%;">

<div class="container">
<div class ="row bg-contentR" >
<div class="col-lg-5" id= "v3">
  <h1>附近500M行業分布圖</h1><br>
  <div id="map2"></div>
</div>
<div class="col-lg-7"><div style="height:100% " id="recommend2">
  </div></div>

</div>
</div>
</div>
</div>

<div role="tabpanel" class="tab-pane section" id="section2" data-anchor="content3">
 <div class="fp-tableCell" style="height: 100%;">

<div class="container">
<div class ="row bg-contentR" >

<div id="v2" class="col-lg-12">
  
</div>
</div>
</div>
</div>
  
</div>
 </div>
<!--  result  main content end--> 
</div></div></div></div>
<!-- /#page-content-wrapper -->
</div>

<script type="text/javascript">

for (var i = 0; i < data2.address.length; i++) {
j=i+1;
if (i==0){
$("#v1").html('<table class="table table-hover"><thead><th><h2>#</h2></th><th><h2>推薦店面</h2></th></thead><tbody><tr><td><h2>'+j+'</h2></td><td><h2>新莊區'+data2.address[i]+'</h2></td></tr>')
}else if (i==data2.address.length){
  $("v1>table").append('<tr><td ><h2>'+j+'</h2></td><td><h2>新莊區'+data2.address[i]+'</h2></td></tr></tbody></table>')
}

else{
 $("#v1>table").append('<tr><td ><h2>'+j+'</h2></td><td><h2>新莊區'+data2.address[i]+'</h2></td></tr>');
}
};
for (var i = 0; i < data2.area.length; i++) {
  j=i+1;
  if(i==0){
  $("#v2").html('<table class="table table-hover"><thead><th><h2>#</h2></th><th><h2>推薦店面</h2></th><th><h2>坪數</h2></th><th><h2>價錢</h2></th><th><h2>聯絡人</h2></th></thead><tbody><tr><td><h2>'+j+'</h2></td><td><h2>新莊區'+data2.address[i]+'</h2></td><td><h2>'+data2.area[i]+'坪</h2></td><td><h2>'+data2.price[i]+'/M</h2></td><td><h2>'+data2.man[i]+'</h2></td></tr>')
}else if (i==data2.area.length){
  $("v2>table").append('<tr><td><h2>'+j+'</h2></td><td><h2>新莊區'+data2.address[i]+'</h2></td><td><h2>'+data2.area[i]+'坪</h2></td><td><h2>'+data2.price[i]+'/M</h2></td><td><h2>'+data2.man[i]+'</h2></td></tr></tbody></table>')
}
else{
 $("#v2>table").append('<tr><td><h2>'+j+'</h2></td><td><h2>新莊區'+data2.address[i]+'</h2></td><td><h2>'+data2.area[i]+'坪</h2></td><td><h2>'+data2.price[i]+'/M</h2></td><td><h2>'+data2.man[i]+'</h2></td></tr>');
}
};



    
  var diameter = 580,
    format = d3.format(",d"),
    color = d3.scale.category20c();

var bubble = d3.layout.pack()
    .sort(null)
    .size([diameter, diameter])
    .padding(1.5);

var svg = d3.select("div#recommend2").append("svg")
    .attr("width", diameter)
    .attr("height", diameter)
    .attr("class", "bubble");

var topsum = data2.jobsum;

var jsondata={"name":"root","children":[{"name":"零售","children":[{"name":"農產品","size":topsum[0]},{"name":"食品什貨","size":topsum[1]},{"name":"菸酒","size":topsum[2]},{"name":"服飾","size":topsum[3]}]},{"name":"家具五金","children":[{"name":"家具","size":topsum[4]},{"name":"五金","size":topsum[5]},{"name":"日用品","size":topsum[6]}]},{"name":"模具水器","children":[{"name":"模具","size":topsum[7]},{"name":"水電行","size":topsum[8]}]},{"name":"藥妝","children":[{"name":"清潔用品","size":topsum[9]},{"name":"化粧品","size":topsum[10]},{"name":"成藥","size":topsum[11]}]},{"name":"雜類","children":[{"name":"樂器","size":topsum[12]},{"name":"建材","size":topsum[13]},{"name":"首飾","size":topsum[22]}]},{"name":"3C","children":[{"name":"電器","size":topsum[14]},{"name":"電腦","size":topsum[15]},{"name":"電信","size":topsum[16]},{"name":"資訊軟體","size":topsum[23]},{"name":"電子材料","size":topsum[24]}]},{"name":"機械","children":[{"name":"機械器具","size":topsum[17]},{"name":"其他機械","size":topsum[18]}]},{"name":"汽機車","children":[{"name":"機車","size":topsum[19]},{"name":"汽機車零件","size":topsum[20]},{"name":"車胎","size":topsum[21]}]},{"name":"吃喝","children":[{"name":"便利商店","size":topsum[25]},{"name":"飲料店","size":topsum[26]},{"name":"餐館","size":topsum[27]}]},{"name":"服務","children":[{"name":"租賃","size":topsum[28]},{"name":"美容美髮","size":topsum[29]}]}]};

d3.json("flare.json", function(error, root) {
  if (error) throw error;
  root =jsondata;
  var node = svg.selectAll(".node")
      .data(bubble.nodes(classes(root))
      .filter(function(d) { return !d.children; }))
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

  node.append("title")
      .text(function(d) { return d.className + ": " + format(d.value); });

  node.append("circle")
      .attr("r", function(d) { return d.r; })
      .style("fill", function(d) { return color(d.packageName); });

  node.append("text")
      .text(function(d) { return d.className.substring(0, d.r / 3); })
      .style("text-anchor", "middle")
      .style("font-size", function(d) { return Math.min(2 * d.r, (2 * d.r - 8) / this.getComputedTextLength() * 12) + "px"; })
      .attr("dy", ".35em");

});

// Returns a flattened hierarchy containing all leaf nodes under the root.
function classes(root) {
  var classes = [];

  function recurse(name, node) {
    if (node.children) node.children.forEach(function(child) { recurse(node.name, child); });
    else classes.push({packageName: name, className: node.name, value: node.size});
  }
  recurse(null, root);
  return {children: classes};
}

d3.select(self.frameElement).style("height", diameter + "px");

</script>
</body>
</html>




